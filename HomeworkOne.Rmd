---
title: "HomeworkOne.RMD"
author: "New River Team"
date: "2025-08-29"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ISLR)
library(dplyr)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

## Problem 3

In the same college data, we have the Private variable, which is an indicator of whether schools are private or public. Use a randomization test (randomized distributions) to test the statement that public schools have more applications than private schools. YOU MAY CHOOSE THE STATISTIC YOU USE FOR COMPARISON (I suggest the mean or the median, i.e, the mean number of applications for public schools is more than the mean number of applications for private schools). Pick a reasonable significance level and state your result. Comment on the data size? Are 777 data points enough to make any conclusions? Defend your statement (you donâ€™t need to do any analysis, but just give reasoning). (Hint: This is very similar to the two-sample randomization test in the marketing example on slide 32. Use Apps instead of profit and Private in place of strategy. You will need to adjust the data sizes to match.) 

```{r overview}
#looking to see what kinds of labels there are and how data is set up
head(College)
```

I'm going to run some basic details on the data set to visualize the distributions and see which statistic I'd like to use for the questions.

```{r basic eval}
#renaming for easier use
priv<-College%>%filter(Private=="Yes")%>%.$Apps
pub<-College%>%filter(Private=="No")%>%.$Apps
#visualization, updating to additional breaks to see more detail in tail
hist(priv, main="Private Apps", breaks=15)
boxplot(priv, main="Private Apps")
hist(pub, main="Public Apps", breaks=15)
boxplot(pub, main="Public Apps")
mean_priv<-mean(priv)
mean_pub<-mean(pub)
med_priv<-median(priv)
med_pub<-median(pub)
mean_priv
mean_pub
med_priv
med_pub
```
Opting to use median since more resistant to extreme outliers, both datasets have odd distributions and are heavily skewed to a long right tail. H_0 is that there is no difference in number of public vs. private school apps. H_A is that there are significantly more applications for public schools than private schools. Selecting .05 significance level since it's not a life or death situation.

```{r checking original data}
length(priv) 
length(pub)

privvpub <-data.frame(apps=c(priv, pub),
  app_type = c(rep("Private", 565),rep("Public", 212)))

observed_dif <- med_pub - med_priv
observed_dif
```

Built out my data frame with original data so that there are two columns with the matching pairs. For the randomization test, I'm going to shuffle the private/public labels to simulate that it doesn't matter. I'm doing this 1000 times.

```{r randomization}

set.seed(89) 
null_results <- NULL
for (i in 1:1000){
  shuffled_labels <- sample(privvpub$app_type, length(privvpub$app_type), replace = FALSE)
  newData <- data.frame(apps = privvpub$apps, app_type = shuffled_labels)
  
#getting the median of the random results for the two groups, saving as random_result then creating a new difference between the two for my null simulated statistic to compare to observed_dif
  random_result <- newData%>%group_by(app_type)%>%summarise(med_apps = median(apps, na.rm = TRUE), .groups = "drop")
  random_result
  
  new_dif <- random_result$med_apps[2] - random_result$med_apps[1]
  new_dif
  
  null_results[i] <- new_dif
}

hist(null_results, main = "Null Sampling Distribution: Median Apps - Public vs. Private", xlab = "Difference in Medians")
abline(v = observed_dif, col = "red", lwd = 2)
  
greaterThanOrig <- null_results > observed_dif
pval <- sum(greaterThanOrig) / 1000
pval
```
My observed difference in medians wasn't even on the chart let along within the normal distribution, so it is extremely unlikely to have been due to chance. Reasonable significance was .05, and my p-value is less than .01, so we have strong reason to reject H_0 and accept H_A, that public schools receive significantly more applications than private schools. 777 data points are definitely enough observations to feel confident in results since it's a relatively large data set. However, a couple of things I am aware of and would factor into how I interpret this data - I have inequal data sets between public and private schools, and there are heavy outliers on both that are pulling the tail farther out. 

AI Disclosure: I used AI to help with R syntax, debug code, and explain some of the coding concepts. All code was written first before asking for modifications/recommendations, and all explanations are my own.

